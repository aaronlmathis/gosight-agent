<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# cmd

```go
import "github.com/aaronlmathis/gosight-agent/cmd"
```

## Index

- [Variables](<#variables>)


## Variables

<a name="Version"></a>

```go
var Version = "dev" // default
```

# gosightagent

```go
import "github.com/aaronlmathis/gosight-agent/internal/agent"
```

Package agent provides the main functionality for the GoSight agent. It handles the initialization and management of various components such as metrics, logs, and processes. The agent is responsible for collecting data from the system and sending it to the GoSight server. It also manages the agent's identity and configuration.

internal/agent/doc.go Package gosightagent is responsible for initializing and managing the Agent lifecycle. It wires together config, metric runner, log runner, and metadata generation.

## Index

- [type Agent](<#Agent>)
  - [func NewAgent\(ctx context.Context, cfg \*config.Config, agentVersion string\) \(\*Agent, error\)](<#NewAgent>)
  - [func \(a \*Agent\) Close\(\)](<#Agent.Close>)
  - [func \(a \*Agent\) Start\(ctx context.Context\)](<#Agent.Start>)


<a name="Agent"></a>
## type [Agent](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/agent/agent.go#L50-L59>)

Agent is a struct that represents the GoSight agent. It contains the configuration, metric runner, log runner, process runner, agent ID, agent version, and metadata.

```go
type Agent struct {
    Config        *config.Config
    MetricRunner  *metricrunner.MetricRunner
    AgentID       string
    AgentVersion  string
    LogRunner     *logrunner.LogRunner
    ProcessRunner *processrunner.ProcessRunner
    Meta          *model.Meta
    Ctx           context.Context
}
```

<a name="NewAgent"></a>
### func [NewAgent](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/agent/agent.go#L66>)

```go
func NewAgent(ctx context.Context, cfg *config.Config, agentVersion string) (*Agent, error)
```

NewAgent creates a new instance of the GoSight agent. It initializes the agent with the provided configuration, context, and agent version. It retrieves the agent ID and builds the base metadata for the agent. It also creates instances of the metric runner, log runner, and process runner. If any of these steps fail, it returns an error.

<a name="Agent.Close"></a>
### func \(\*Agent\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/agent/agent.go#L123>)

```go
func (a *Agent) Close()
```

Close stops all runners and closes the gRPC connection. It waits for all runners to finish before closing the connection.

<a name="Agent.Start"></a>
### func \(\*Agent\) [Start](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/agent/agent.go#L107>)

```go
func (a *Agent) Start(ctx context.Context)
```

Start initializes and starts the metric, log, and process runners. It runs each runner in a separate goroutine. The context is used to manage the lifecycle of the runners. The function logs the start of each runner and handles any errors that may occur.

# bootstrap

```go
import "github.com/aaronlmathis/gosight-agent/internal/bootstrap"
```

internal/bootstrap/doc.go Package bootstrap provides the entrypoint for initializing configuration, metadata, and the main Agent instance.

server/internal/bootstrap/logger.go Initializes logger.

## Index

- [func LoadAgentConfig\(\) \*config.Config](<#LoadAgentConfig>)
- [func SetupLogging\(cfg \*config.Config\)](<#SetupLogging>)


<a name="LoadAgentConfig"></a>
## func [LoadAgentConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/bootstrap/config.go#L40>)

```go
func LoadAgentConfig() *config.Config
```

LoadAgentConfig loads the agent configuration from a file, environment variables, and command\-line flags. It applies the overrides in the following order: command\-line flags \> environment variables \> config file. The function returns a pointer to the loaded configuration.

<a name="SetupLogging"></a>
## func [SetupLogging](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/bootstrap/logger.go#L34>)

```go
func SetupLogging(cfg *config.Config)
```



# command

```go
import "github.com/aaronlmathis/gosight-agent/internal/command"
```

## Index

- [func HandleCommand\(ctx context.Context, cmd \*proto.CommandRequest\) \*proto.CommandResponse](<#HandleCommand>)


<a name="HandleCommand"></a>
## func [HandleCommand](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/command/command.go#L36>)

```go
func HandleCommand(ctx context.Context, cmd *proto.CommandRequest) *proto.CommandResponse
```

HandleCommand processes incoming command requests based on their type. It supports "shell" commands for executing shell commands and "ansible" commands for running Ansible playbooks.

# config

```go
import "github.com/aaronlmathis/gosight-agent/internal/config"
```

SPDX\-License\-Identifier: GPL\-3.0\-or\-later

Copyright \(C\) 2025 Aaron Mathis aaron.mathis@gmail.com

This file is part of GoSight.

GoSight is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or \(at your option\) any later version.

GoSight is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with GoSight. If not, see https://www.gnu.org/licenses/.

internal/config/config.go Package config provides functions to load and manage the configuration for the GoSight agent. It handles loading the configuration from a YAML file, applying environment variable overrides, and parsing CSV strings into slices. The configuration includes settings for TLS, logging, Podman and Docker integration, custom tags, and various collection intervals for metrics, logs, and processes. The configuration is structured to allow for easy modification and extension as needed.

internal/config/doc.go Package config handles reading, parsing, and validating the GoSight agent configuration file.

## Index

- [func ApplyEnvOverrides\(cfg \*Config\)](<#ApplyEnvOverrides>)
- [func EnsureDefaultConfig\(path string\) error](<#EnsureDefaultConfig>)
- [func SplitCSV\(input string\) \[\]string](<#SplitCSV>)
- [type Config](<#Config>)
  - [func LoadConfig\(path string\) \(\*Config, error\)](<#LoadConfig>)
- [type LogCollectionConfig](<#LogCollectionConfig>)
- [type MetricCollectionConfig](<#MetricCollectionConfig>)
- [type ProcessCollectionConfig](<#ProcessCollectionConfig>)


<a name="ApplyEnvOverrides"></a>
## func [ApplyEnvOverrides](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L146>)

```go
func ApplyEnvOverrides(cfg *Config)
```

ApplyEnvOverrides applies environment variable overrides to the configuration. It checks for specific environment variables and updates the corresponding fields in the Config struct. If an environment variable is set, it overrides the value in the configuration. The function prints the overridden values to the console. This allows users to customize the configuration without modifying the YAML file. The function handles various settings such as server URL, collection intervals, log file paths, TLS certificates, and custom tags. It also validates the format of the GOSIGHT\_INTERVAL environment variable to ensure it is a valid duration.

<a name="EnsureDefaultConfig"></a>
## func [EnsureDefaultConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/default.go#L74>)

```go
func EnsureDefaultConfig(path string) error
```



<a name="SplitCSV"></a>
## func [SplitCSV](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L245>)

```go
func SplitCSV(input string) []string
```

SplitCSV splits a CSV string into a slice of strings. It trims whitespace from each element and ignores empty elements. This function is useful for parsing comma\-separated values from configuration files.

<a name="Config"></a>
## type [Config](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L75-L117>)

Config holds the configuration for the GoSight agent. It includes settings for TLS, logging, Podman and Docker integration, custom tags, and various collection intervals for metrics, logs, and processes. The configuration is loaded from a YAML file and can be overridden by environment variables. The configuration is structured to allow for easy modification and extension as needed.

```go
type Config struct {
    TLS struct {
        CAFile   string `yaml:"ca_file"`   // used by agent to trust the server
        CertFile string `yaml:"cert_file"` // optional (for mTLS)
        KeyFile  string `yaml:"key_file"`  // optional (for mTLS)
    }

    Logs struct {
        ErrorLogFile  string `yaml:"error_log_file"`
        AppLogFile    string `yaml:"app_log_file"`
        AccessLogFile string `yaml:"access_log_file"`
        LogLevel      string `yaml:"log_level"`
    }

    Podman struct {
        Socket  string `yaml:"socket"`
        Enabled bool   `yaml:"enabled"`
    }

    Docker struct {
        Socket  string `yaml:"socket"`
        Enabled bool   `yaml:"enabled"`
    }

    CustomTags map[string]string `yaml:"custom_tags"` // static tags to be sent with every metric

    Agent struct {
        ServerURL    string        `yaml:"server_url"`
        Interval     time.Duration `yaml:"interval"`
        HostOverride string        `yaml:"host"`

        MetricCollection  MetricCollectionConfig  `yaml:"metric_collection"`
        LogCollection     LogCollectionConfig     `yaml:"log_collection"`
        ProcessCollection ProcessCollectionConfig `yaml:"process_collection"`

        Environment   string `yaml:"environment"`
        AppLogFile    string `yaml:"app_log_file"`
        ErrorLogFile  string `yaml:"error_log_file"`
        AccessLogFile string `yaml:"access_log_file"`
        DebugLogFile  string `yaml:"debug_log_file"`
        LogLevel      string `yaml:"log_level"`
    }
}
```

<a name="LoadConfig"></a>
### func [LoadConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L125>)

```go
func LoadConfig(path string) (*Config, error)
```

LoadConfig loads the configuration from a YAML file. It returns a Config struct and an error if any occurred during loading. The configuration file path is passed as an argument. The function reads the file, unmarshals the YAML data into the Config struct, and returns the struct. If the file cannot be read or the data cannot be unmarshaled, an error is returned.

<a name="LogCollectionConfig"></a>
## type [LogCollectionConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L43-L51>)



```go
type LogCollectionConfig struct {
    Interval   time.Duration `yaml:"interval"`
    Sources    []string      `yaml:"sources"`
    Services   []string      `yaml:"services"`
    BatchSize  int           `yaml:"batch_size"`
    BufferSize int           `yaml:"buffer_size"`
    Workers    int           `yaml:"workers"`
    MessageMax int           `yaml:"message_max"`
}
```

<a name="MetricCollectionConfig"></a>
## type [MetricCollectionConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L56-L60>)

MetricCollectionConfig defines the configuration for metric collection It includes settings for the collection interval, sources, and number of workers. The sources can be a list of metrics to collect, such as CPU, memory, etc.

```go
type MetricCollectionConfig struct {
    Interval time.Duration `yaml:"interval"`
    Sources  []string      `yaml:"sources"`
    Workers  int           `yaml:"workers"`
}
```

<a name="ProcessCollectionConfig"></a>
## type [ProcessCollectionConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L65-L68>)

ProcessCollectionConfig defines the configuration for process collection It includes settings for the collection interval and number of workers. The process collection can be used to monitor running processes and their resource usage.

```go
type ProcessCollectionConfig struct {
    Interval time.Duration `yaml:"interval"`
    Workers  int           `yaml:"workers"`
}
```

# grpcconn

```go
import "github.com/aaronlmathis/gosight-agent/internal/grpc"
```

SPDX\-License\-Identifier: GPL\-3.0\-or\-later

Copyright \(C\) 2025 Aaron Mathis aaron.mathis@gmail.com

This file is part of GoSight.

GoSight is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or \(at your option\) any later version.

GoSight is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with GoSight. If not, see https://www.gnu.org/licenses/.

agent/internal/grpc/connection.go Package grpcconn provides a singleton gRPC connection for the GoSight agent.

internal/grpc/doc.go Package grpcconn manages the gRPC connection and stream between agent and server.

## Index

- [func CloseGRPCConn\(\) error](<#CloseGRPCConn>)
- [func GetGRPCConn\(cfg \*config.Config\) \(\*grpc.ClientConn, error\)](<#GetGRPCConn>)


<a name="CloseGRPCConn"></a>
## func [CloseGRPCConn](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/grpc/connection.go#L90>)

```go
func CloseGRPCConn() error
```

CloseGRPCConn closes the connection \(for shutdown\)

<a name="GetGRPCConn"></a>
## func [GetGRPCConn](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/grpc/connection.go#L47>)

```go
func GetGRPCConn(cfg *config.Config) (*grpc.ClientConn, error)
```

GetGRPCConn returns the singleton ClientConn for the gRPC connection. It creates a new connection if one does not already exist. The connection is configured with TLS and various gRPC options. It is safe for concurrent use. Note: This function does not block until the connection is established.

# agentidentity

```go
import "github.com/aaronlmathis/gosight-agent/internal/identity"
```

internal/identity/doc.go Package agentidentity generates and persists a unique Agent ID. It ensures consistent identification across restarts.

## Index

- [func LoadOrCreateAgentID\(\) \(string, error\)](<#LoadOrCreateAgentID>)


<a name="LoadOrCreateAgentID"></a>
## func [LoadOrCreateAgentID](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/identity/agentid.go#L37>)

```go
func LoadOrCreateAgentID() (string, error)
```

LoadOrCreateAgentID returns a stable UUID stored on disk. It creates a new one on first run and saves it to disk.

# meta

```go
import "github.com/aaronlmathis/gosight-agent/internal/meta"
```

internal/meta/doc.go Package meta provides utilities for building and cloning metadata for metric and log payloads.

## Index

- [func BuildContainerMeta\(cfg \*config.Config, addTags map\[string\]string, agentID, agentVersion string\) \*model.Meta](<#BuildContainerMeta>)
- [func BuildMeta\(cfg \*config.Config, addTags map\[string\]string, agentID, agentVersion string\) \*model.Meta](<#BuildMeta>)
- [func BuildStandardTags\(meta \*model.Meta, m model.Metric, isContainer bool, startTime time.Time\)](<#BuildStandardTags>)
- [func CloneMetaWithTags\(base \*model.Meta, extraTags map\[string\]string\) \*model.Meta](<#CloneMetaWithTags>)


<a name="BuildContainerMeta"></a>
## func [BuildContainerMeta](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/meta/meta.go#L102>)

```go
func BuildContainerMeta(cfg *config.Config, addTags map[string]string, agentID, agentVersion string) *model.Meta
```

BuildContainerMeta builds a container\-specific meta object It includes additional fields relevant to containerized environments such as container ID, image name, and runtime information.

<a name="BuildMeta"></a>
## func [BuildMeta](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/meta/meta.go#L41>)

```go
func BuildMeta(cfg *config.Config, addTags map[string]string, agentID, agentVersion string) *model.Meta
```



<a name="BuildStandardTags"></a>
## func [BuildStandardTags](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/meta/tags.go#L37>)

```go
func BuildStandardTags(meta *model.Meta, m model.Metric, isContainer bool, startTime time.Time)
```

BuildStandardTags sets required labels for consistent metric identity and filtering. It sets the "namespace" and "job" labels, which are used to identify the source of the metric.

<a name="CloneMetaWithTags"></a>
## func [CloneMetaWithTags](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/meta/meta.go#L85>)

```go
func CloneMetaWithTags(base *model.Meta, extraTags map[string]string) *model.Meta
```

CloneMetaWithTags returns a shallow copy of the base Meta but optionally overrides or adds new Tags.

# protohelper

```go
import "github.com/aaronlmathis/gosight-agent/internal/protohelper"
```

## Index

- [func ConvertLogMetaToProto\(m \*model.LogMeta\) \*proto.LogMeta](<#ConvertLogMetaToProto>)
- [func ConvertMetaToProtoMeta\(m \*model.Meta\) \*proto.Meta](<#ConvertMetaToProtoMeta>)
- [func ConvertToProtoPayload\(payload model.MetricPayload\) \*proto.MetricPayload](<#ConvertToProtoPayload>)


<a name="ConvertLogMetaToProto"></a>
## func [ConvertLogMetaToProto](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/protohelper/convert.go#L80>)

```go
func ConvertLogMetaToProto(m *model.LogMeta) *proto.LogMeta
```



<a name="ConvertMetaToProtoMeta"></a>
## func [ConvertMetaToProtoMeta](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/protohelper/convert.go#L103>)

```go
func ConvertMetaToProtoMeta(m *model.Meta) *proto.Meta
```



<a name="ConvertToProtoPayload"></a>
## func [ConvertToProtoPayload](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/protohelper/convert.go#L36>)

```go
func ConvertToProtoPayload(payload model.MetricPayload) *proto.MetricPayload
```



# agentutils

```go
import "github.com/aaronlmathis/gosight-agent/internal/utils"
```

SPDX\-License\-Identifier: GPL\-3.0\-or\-later

Copyright \(C\) 2025 Aaron Mathis aaron.mathis@gmail.com

This file is part of GoSight.

GoSight is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or \(at your option\) any later version.

GoSight is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with GoSight. If not, see https://www.gnu.org/licenses/.

agent/internal/utils/cursor.go

## Index

- [func ErrMsg\(err error\) string](<#ErrMsg>)
- [func GetHostname\(\) string](<#GetHostname>)
- [func Keys\(m map\[string\]bool\) \[\]string](<#Keys>)
- [func LoadCursor\(path string\) \(string, error\)](<#LoadCursor>)
- [func LoadTLSConfig\(cfg \*config.Config\) \(\*tls.Config, error\)](<#LoadTLSConfig>)
- [func Metric\(ns, sub, name string, value interface\{\}, typ, unit string, dims map\[string\]string, ts time.Time\) model.Metric](<#Metric>)
- [func SaveCursor\(path, cursor string\) error](<#SaveCursor>)
- [func ToFloat64\(v interface\{\}\) float64](<#ToFloat64>)


<a name="ErrMsg"></a>
## func [ErrMsg](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/utils/sys_utils.go#L88>)

```go
func ErrMsg(err error) string
```

ErrMsg returns the error message if err is not nil, otherwise returns an empty string.

<a name="GetHostname"></a>
## func [GetHostname](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/utils/sys_utils.go#L79>)

```go
func GetHostname() string
```

GetHostname returns the system hostname, or "unknown" if it can't be determined.

<a name="Keys"></a>
## func [Keys](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/utils/sys_utils.go#L97>)

```go
func Keys(m map[string]bool) []string
```

Keys returns a slice of keys from the given map\[string\]bool. It iterates over the map and appends each key to a slice.

<a name="LoadCursor"></a>
## func [LoadCursor](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/utils/cursor.go#L31>)

```go
func LoadCursor(path string) (string, error)
```

LoadCursor reads the last saved journald cursor from a file. It returns an empty string and nil error if the file does not exist.

<a name="LoadTLSConfig"></a>
## func [LoadTLSConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/utils/tls.go#L40>)

```go
func LoadTLSConfig(cfg *config.Config) (*tls.Config, error)
```

LoadTLSConfig loads the TLS configuration for the agent. It reads the CA certificate and client certificate/key from the specified paths. It returns a tls.Config object that can be used for secure communication.

<a name="Metric"></a>
## func [Metric](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/utils/sys_utils.go#L41>)

```go
func Metric(ns, sub, name string, value interface{}, typ, unit string, dims map[string]string, ts time.Time) model.Metric
```

Metric creates a new model.Metric instance with the provided parameters. It sets the namespace, sub\-namespace, name, value, type, unit, dimensions, and timestamp for the metric. The value is converted to a float64 using the ToFloat64 function. The function returns the created model.Metric instance.

<a name="SaveCursor"></a>
## func [SaveCursor](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/utils/cursor.go#L43>)

```go
func SaveCursor(path, cursor string) error
```

SaveCursor writes the given journald cursor to a file.

<a name="ToFloat64"></a>
## func [ToFloat64](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/utils/sys_utils.go#L58>)

```go
func ToFloat64(v interface{}) float64
```

ToFloat64 converts a given value to float64. It handles various numeric types such as float64, int, uint64, uint32, int64, and int32. If the value is of an unknown type, it logs a warning and returns 0.

# logcollector

```go
import "github.com/aaronlmathis/gosight-agent/internal/logs/logcollector"
```

internal/logs/logcollector/doc.go Package logcollector contains log collection infrastructure including runners, collectors, and senders.

## Index

- [type Collector](<#Collector>)
- [type LogRegistry](<#LogRegistry>)
  - [func NewRegistry\(cfg \*config.Config\) \*LogRegistry](<#NewRegistry>)
  - [func \(r \*LogRegistry\) Close\(\) error](<#LogRegistry.Close>)
  - [func \(r \*LogRegistry\) Collect\(ctx context.Context\) \(\[\]\[\]model.LogEntry, error\)](<#LogRegistry.Collect>)


<a name="Collector"></a>
## type [Collector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/collector.go#L35-L38>)

Collector is an interface that defines the methods for a log collector. It includes methods for collecting logs and returning them in a specific format.

```go
type Collector interface {
    Name() string
    Collect(ctx context.Context) ([][]model.LogEntry, error)
}
```

<a name="LogRegistry"></a>
## type [LogRegistry](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/registry.go#L45-L47>)

LogRegistry holds active log collectors keyed by name It is responsible for managing the lifecycle of log collectors, including their initialization, collection of logs, and closing them when no longer needed.

```go
type LogRegistry struct {
    LogCollectors map[string]Collector
}
```

<a name="NewRegistry"></a>
### func [NewRegistry](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/registry.go#L51>)

```go
func NewRegistry(cfg *config.Config) *LogRegistry
```

NewRegistry initializes and registers enabled log collectors based on the configuration. It creates a new LogRegistry instance and populates it with the specified collectors.

<a name="LogRegistry.Close"></a>
### func \(\*LogRegistry\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/registry.go#L103>)

```go
func (r *LogRegistry) Close() error
```

Close cleans up the resources used by the LogRegistry. It closes all log collectors and handles any errors that occur during the closing process. It should be called when the LogRegistry is no longer needed.

<a name="LogRegistry.Collect"></a>
### func \(\*LogRegistry\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/registry.go#L84>)

```go
func (r *LogRegistry) Collect(ctx context.Context) ([][]model.LogEntry, error)
```

Collect runs all active collectors and returns all collected metrics as a slice. It iterates over the registered collectors, calls their Collect method, and appends the resulting metrics to a slice.

# logrunner

```go
import "github.com/aaronlmathis/gosight-agent/internal/logs/logrunner"
```

internal/logs/logrunner/doc.go Package logrunner contains log collection

SPDX\-License\-Identifier: GPL\-3.0\-or\-later

Copyright \(C\) 2025 Aaron Mathis aaron.mathis@gmail.com

This file is part of GoSight.

GoSight is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or \(at your option\) any later version.

GoSight is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with GoSight. If not, see https://www.gnu.org/licenses/.

## Index

- [type LogRunner](<#LogRunner>)
  - [func NewRunner\(ctx context.Context, cfg \*config.Config, baseMeta \*model.Meta\) \(\*LogRunner, error\)](<#NewRunner>)
  - [func \(r \*LogRunner\) Close\(\)](<#LogRunner.Close>)
  - [func \(r \*LogRunner\) Run\(ctx context.Context\)](<#LogRunner.Run>)


<a name="LogRunner"></a>
## type [LogRunner](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logrunner/runner.go#L41-L47>)

LogRunner is a struct that handles the collection and sending of log data. It manages the log collection interval, the task queue, and the log sender. It implements the Run method to start the collection process and the Close method to clean up resources.

```go
type LogRunner struct {
    Config      *config.Config
    LogSender   *logsender.LogSender
    LogRegistry *logcollector.LogRegistry
    Meta        *model.Meta
    // contains filtered or unexported fields
}
```

<a name="NewRunner"></a>
### func [NewRunner](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logrunner/runner.go#L52>)

```go
func NewRunner(ctx context.Context, cfg *config.Config, baseMeta *model.Meta) (*LogRunner, error)
```

NewRunner creates a new LogRunner instance. It initializes the log sender and sets up the context for the runner. It returns a pointer to the LogRunner and an error if any occurs during initialization.

<a name="LogRunner.Close"></a>
### func \(\*LogRunner\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logrunner/runner.go#L74>)

```go
func (r *LogRunner) Close()
```

Close cleans up the resources used by the LogRunner. It closes the log sender and the log registry. It should be called when the LogRunner is no longer needed.

<a name="LogRunner.Run"></a>
### func \(\*LogRunner\) [Run](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logrunner/runner.go#L96>)

```go
func (r *LogRunner) Run(ctx context.Context)
```



# logsender

```go
import "github.com/aaronlmathis/gosight-agent/internal/logs/logsender"
```

internal/logs/logsender/doc.go Package logsender contains log sending

## Index

- [type LogSender](<#LogSender>)
  - [func NewSender\(ctx context.Context, cfg \*config.Config\) \(\*LogSender, error\)](<#NewSender>)
  - [func \(s \*LogSender\) Close\(\) error](<#LogSender.Close>)
  - [func \(s \*LogSender\) SendLogs\(payload \*model.LogPayload\) error](<#LogSender.SendLogs>)
  - [func \(s \*LogSender\) StartWorkerPool\(ctx context.Context, queue \<\-chan \*model.LogPayload, workerCount int\)](<#LogSender.StartWorkerPool>)


<a name="LogSender"></a>
## type [LogSender](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logsender/sender.go#L43-L49>)

Sender holds the gRPC client and connection

```go
type LogSender struct {
    Config *config.Config
    // contains filtered or unexported fields
}
```

<a name="NewSender"></a>
### func [NewSender](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logsender/sender.go#L55>)

```go
func NewSender(ctx context.Context, cfg *config.Config) (*LogSender, error)
```

NewSender establishes a gRPC connection to the server and creates a new LogSender instance. It takes a context and a configuration object as parameters. The function returns a pointer to the LogSender instance and an error if any occurs during the process. It also sets up a stream for sending log data to the server.

<a name="LogSender.Close"></a>
### func \(\*LogSender\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logsender/sender.go#L84>)

```go
func (s *LogSender) Close() error
```

Close closes the gRPC connection and waits for all workers to finish. It returns an error if any occurs during the process. The function uses a wait group to ensure that all workers have completed their tasks before closing the connection. It also logs the status of the workers.

<a name="LogSender.SendLogs"></a>
### func \(\*LogSender\) [SendLogs](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logsender/sender.go#L94>)

```go
func (s *LogSender) SendLogs(payload *model.LogPayload) error
```

SendLogs sends a log payload to the gRPC server. It takes a pointer to a LogPayload object as a parameter. The function converts the log payload to a protobuf format and sends it to the server.

<a name="LogSender.StartWorkerPool"></a>
### func \(\*LogSender\) [StartWorkerPool](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logsender/task.go#L39>)

```go
func (s *LogSender) StartWorkerPool(ctx context.Context, queue <-chan *model.LogPayload, workerCount int)
```

StartWorkerPool launches N workers and processes metric payloads with retries in case of transient errors. Each worker will attempt to send the payload to the gRPC server. The number of workers is determined by the workerCount parameter. The workers will run until the context is done or an error occurs.

# metriccollector

```go
import "github.com/aaronlmathis/gosight-agent/internal/metrics/metriccollector"
```

## Index

- [type MetricCollector](<#MetricCollector>)
- [type MetricRegistry](<#MetricRegistry>)
  - [func NewRegistry\(cfg \*config.Config\) \*MetricRegistry](<#NewRegistry>)
  - [func \(r \*MetricRegistry\) Collect\(ctx context.Context\) \(\[\]model.Metric, error\)](<#MetricRegistry.Collect>)


<a name="MetricCollector"></a>
## type [MetricCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/metriccollector.go#L34-L37>)

Collector is the interface that all metric collectors must implement.

```go
type MetricCollector interface {
    Name() string
    Collect(ctx context.Context) ([]model.Metric, error)
}
```

<a name="MetricRegistry"></a>
## type [MetricRegistry](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/registry.go#L38-L40>)

Registry holds active collectors keyed by name

```go
type MetricRegistry struct {
    Collectors map[string]MetricCollector
}
```

<a name="NewRegistry"></a>
### func [NewRegistry](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/registry.go#L47>)

```go
func NewRegistry(cfg *config.Config) *MetricRegistry
```

NewRegistry initializes and registers enabled collectors based on the configuration. It creates a new MetricRegistry instance and populates it with the specified collectors. The collectors are created based on the configuration settings and are stored in a map. The function returns a pointer to the MetricRegistry instance. It also logs the number of loaded collectors for debugging purposes.

<a name="MetricRegistry.Collect"></a>
### func \(\*MetricRegistry\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/registry.go#L76>)

```go
func (r *MetricRegistry) Collect(ctx context.Context) ([]model.Metric, error)
```

Collect runs all active collectors and returns all collected metrics

# metricrunner

```go
import "github.com/aaronlmathis/gosight-agent/internal/metrics/metricrunner"
```

SPDX\-License\-Identifier: GPL\-3.0\-or\-later

Copyright \(C\) 2025 Aaron Mathis aaron.mathis@gmail.com

This file is part of GoSight.

GoSight is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or \(at your option\) any later version.

GoSight is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with GoSight. If not, see https://www.gnu.org/licenses/.

agent/internal/metrics/metricrunner/runner.go

## Index

- [type MetricRunner](<#MetricRunner>)
  - [func NewRunner\(ctx context.Context, cfg \*config.Config, baseMeta \*model.Meta\) \(\*MetricRunner, error\)](<#NewRunner>)
  - [func \(r \*MetricRunner\) Close\(\)](<#MetricRunner.Close>)
  - [func \(r \*MetricRunner\) Run\(ctx context.Context\)](<#MetricRunner.Run>)


<a name="MetricRunner"></a>
## type [MetricRunner](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricrunner/runner.go#L41-L47>)

MetricRunner is a struct that handles the collection and sending of metrics. It manages the metric collection interval, the task queue, and the metric sender. It implements the Run method to start the collection process and the Close method to clean up resources.

```go
type MetricRunner struct {
    Config         *config.Config
    MetricSender   *metricsender.MetricSender
    MetricRegistry *metriccollector.MetricRegistry
    StartTime      time.Time
    Meta           *model.Meta
}
```

<a name="NewRunner"></a>
### func [NewRunner](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricrunner/runner.go#L53>)

```go
func NewRunner(ctx context.Context, cfg *config.Config, baseMeta *model.Meta) (*MetricRunner, error)
```

NewRunner creates a new MetricRunner instance. It initializes the metric sender and sets up the context for the runner. It returns a pointer to the MetricRunner and an error if any occurs during initialization. The MetricRunner is responsible for collecting and sending metrics to the server.

<a name="MetricRunner.Close"></a>
### func \(\*MetricRunner\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricrunner/runner.go#L76>)

```go
func (r *MetricRunner) Close()
```

Close closes the metric sender. It cleans up resources and ensures that the sender is properly closed. This is important to prevent resource leaks and ensure that all data is sent before shutting down.

<a name="MetricRunner.Run"></a>
### func \(\*MetricRunner\) [Run](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricrunner/runner.go#L87>)

```go
func (r *MetricRunner) Run(ctx context.Context)
```

RunAgent starts the agent's collection loop and sends tasks to the pool of workers. It collects metrics at the specified interval and sends them to the server. The method runs indefinitely until the context is done. It handles the collection of both host and container metrics. The host metrics are sent as a single payload, while container metrics are sent as separate payloads.

# metricsender

```go
import "github.com/aaronlmathis/gosight-agent/internal/metrics/metricsender"
```

SPDX\-License\-Identifier: GPL\-3.0\-or\-later

Copyright \(C\) 2025 Aaron Mathis aaron.mathis@gmail.com

This file is part of GoSight.

GoSight is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or \(at your option\) any later version.

GoSight is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with GoSight. If not, see https://www.gnu.org/licenses/.

## Index

- [func AppendMetricsToFile\(payload \*model.MetricPayload, filename string\) error](<#AppendMetricsToFile>)
- [type MetricSender](<#MetricSender>)
  - [func NewSender\(ctx context.Context, cfg \*config.Config\) \(\*MetricSender, error\)](<#NewSender>)
  - [func \(s \*MetricSender\) Close\(\) error](<#MetricSender.Close>)
  - [func \(s \*MetricSender\) SendMetrics\(payload \*model.MetricPayload\) error](<#MetricSender.SendMetrics>)
  - [func \(s \*MetricSender\) StartWorkerPool\(ctx context.Context, queue \<\-chan \*model.MetricPayload, workerCount int\)](<#MetricSender.StartWorkerPool>)


<a name="AppendMetricsToFile"></a>
## func [AppendMetricsToFile](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricsender/debugging.go#L35>)

```go
func AppendMetricsToFile(payload *model.MetricPayload, filename string) error
```

AppendMetricsToFile appends the given MetricPayload to a file in JSON format. It creates the directory if it doesn't exist. The file is opened in append mode, and the payload is written as a newline\-delimited JSON object. This is useful for debugging purposes, allowing you to inspect the metrics being sent.

<a name="MetricSender"></a>
## type [MetricSender](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricsender/sender.go#L45-L52>)

Sender holds the gRPC client and connection

```go
type MetricSender struct {
    // contains filtered or unexported fields
}
```

<a name="NewSender"></a>
### func [NewSender](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricsender/sender.go#L57>)

```go
func NewSender(ctx context.Context, cfg *config.Config) (*MetricSender, error)
```

NewSender establishes a gRPC connection and creates a stream for sending metrics It returns a MetricSender instance

<a name="MetricSender.Close"></a>
### func \(\*MetricSender\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricsender/sender.go#L90>)

```go
func (s *MetricSender) Close() error
```

Close waits for all workers to finish and closes the gRPC connection It returns an error if the connection could not be closed or if any worker failed

<a name="MetricSender.SendMetrics"></a>
### func \(\*MetricSender\) [SendMetrics](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricsender/sender.go#L100>)

```go
func (s *MetricSender) SendMetrics(payload *model.MetricPayload) error
```

SendMetrics sends a MetricPayload to the server It converts the MetricPayload to a protobuf message and sends it over the gRPC stream

<a name="MetricSender.StartWorkerPool"></a>
### func \(\*MetricSender\) [StartWorkerPool](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricsender/task.go#L43>)

```go
func (s *MetricSender) StartWorkerPool(ctx context.Context, queue <-chan *model.MetricPayload, workerCount int)
```

StartWorkerPool launches N workers and processes metric payloads with retries in case of transient errors. Each worker will attempt to send the payload to the gRPC server. The number of workers is determined by the workerCount parameter. The workers will run until the context is done or an error occurs. The function uses a goroutine for each worker, allowing them to run concurrently.

# processcollector

```go
import "github.com/aaronlmathis/gosight-agent/internal/processes/processcollector"
```

## Index

- [func CollectProcesses\(ctx context.Context\) \(\*model.ProcessSnapshot, error\)](<#CollectProcesses>)


<a name="CollectProcesses"></a>
## func [CollectProcesses](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processcollector/process.go#L39>)

```go
func CollectProcesses(ctx context.Context) (*model.ProcessSnapshot, error)
```

Collector captures running processes

# processrunner

```go
import "github.com/aaronlmathis/gosight-agent/internal/processes/processrunner"
```

## Index

- [type ProcessRunner](<#ProcessRunner>)
  - [func NewRunner\(ctx context.Context, cfg \*config.Config, baseMeta \*model.Meta\) \(\*ProcessRunner, error\)](<#NewRunner>)
  - [func \(r \*ProcessRunner\) Close\(\)](<#ProcessRunner.Close>)
  - [func \(r \*ProcessRunner\) Run\(ctx context.Context\)](<#ProcessRunner.Run>)
  - [func \(r \*ProcessRunner\) SetDisconnectHandler\(fn func\(\)\)](<#ProcessRunner.SetDisconnectHandler>)


<a name="ProcessRunner"></a>
## type [ProcessRunner](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processrunner/processrunner.go#L44-L48>)

ProcessRunner is a struct that handles the collection and sending of process data. It manages the process collection interval, the task queue, and the process sender. It implements the Run method to start the collection process and the Close method to clean up resources.

```go
type ProcessRunner struct {
    Config        *config.Config
    ProcessSender *processsender.ProcessSender
    Meta          *model.Meta
}
```

<a name="NewRunner"></a>
### func [NewRunner](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processrunner/processrunner.go#L53>)

```go
func NewRunner(ctx context.Context, cfg *config.Config, baseMeta *model.Meta) (*ProcessRunner, error)
```

NewRunner creates a new ProcessRunner instance. It initializes the process sender and sets up the context for the runner. It returns a pointer to the ProcessRunner and an error if any occurs during initialization.

<a name="ProcessRunner.Close"></a>
### func \(\*ProcessRunner\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processrunner/processrunner.go#L75>)

```go
func (r *ProcessRunner) Close()
```

Close closes the process sender and cleans up resources. It ensures that all resources are released and the connection to the server is properly closed. This method should be called when the process runner is no longer needed.

<a name="ProcessRunner.Run"></a>
### func \(\*ProcessRunner\) [Run](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processrunner/processrunner.go#L87>)

```go
func (r *ProcessRunner) Run(ctx context.Context)
```

Run starts the process collection and sending loop. It collects process data at the specified interval and sends it to the server. The method runs indefinitely until the context is done or an error occurs. It uses a ticker to trigger the collection process at regular intervals. The collected process data is sent to a task queue, which is processed by a worker pool. The worker pool is managed by the ProcessSender, which handles the sending of data to the server.

<a name="ProcessRunner.SetDisconnectHandler"></a>
### func \(\*ProcessRunner\) [SetDisconnectHandler](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processrunner/processrunner.go#L68>)

```go
func (r *ProcessRunner) SetDisconnectHandler(fn func())
```

SetDisconnectHandler sets a handler function to be called when the process sender disconnects. This allows the user to define custom behavior when the connection to the server is lost. The handler function will be called when the disconnect event occurs.

# processsender

```go
import "github.com/aaronlmathis/gosight-agent/internal/processes/processsender"
```

agent/processes/processsender/sender.go Package processsender provides functionality to send process data to a gRPC server. It handles the connection to the server, sending process snapshots, and reconnecting the stream in case of disconnection.

## Index

- [type ProcessSender](<#ProcessSender>)
  - [func NewSender\(ctx context.Context, cfg \*config.Config\) \(\*ProcessSender, error\)](<#NewSender>)
  - [func \(s \*ProcessSender\) Close\(\) error](<#ProcessSender.Close>)
  - [func \(s \*ProcessSender\) SendSnapshot\(payload \*model.ProcessPayload\) error](<#ProcessSender.SendSnapshot>)
  - [func \(s \*ProcessSender\) SetDisconnectHandler\(fn func\(\)\)](<#ProcessSender.SetDisconnectHandler>)
  - [func \(s \*ProcessSender\) StartWorkerPool\(\_ context.Context, queue \<\-chan \*model.ProcessPayload, workerCount int\)](<#ProcessSender.StartWorkerPool>)


<a name="ProcessSender"></a>
## type [ProcessSender](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processsender/processsender.go#L52-L62>)

ProcessSender is a struct that handles sending process data to a gRPC server. It manages the connection to the server, sending process snapshots, and reconnecting the stream in case of disconnection. It implements the Close method to clean up resources and the SendSnapshot method to send process data.

```go
type ProcessSender struct {
    // contains filtered or unexported fields
}
```

<a name="NewSender"></a>
### func [NewSender](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processsender/processsender.go#L68>)

```go
func NewSender(ctx context.Context, cfg *config.Config) (*ProcessSender, error)
```

NewSender creates a new ProcessSender instance. It initializes the gRPC connection and stream to the server. It returns a pointer to the ProcessSender and an error if any occurs during initialization. The context is used to manage the lifecycle of the sender.

<a name="ProcessSender.Close"></a>
### func \(\*ProcessSender\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processsender/processsender.go#L101>)

```go
func (s *ProcessSender) Close() error
```

Close closes the gRPC connection and waits for all background workers to finish. It cancels the stream context to stop any active Send operations. It returns an error if any occurs during the closing process.

<a name="ProcessSender.SendSnapshot"></a>
### func \(\*ProcessSender\) [SendSnapshot](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processsender/processsender.go#L129>)

```go
func (s *ProcessSender) SendSnapshot(payload *model.ProcessPayload) error
```

SendSnapshot sends a snapshot of process data to the gRPC server. It marshals the process data into a protobuf message and sends it over the stream. It handles reconnections in case of disconnection or errors during sending. It returns an error if any occurs during the sending process.

<a name="ProcessSender.SetDisconnectHandler"></a>
### func \(\*ProcessSender\) [SetDisconnectHandler](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processsender/processsender.go#L94>)

```go
func (s *ProcessSender) SetDisconnectHandler(fn func())
```

SetDisconnectHandler sets a callback function to be called when the sender disconnects. This is useful for handling reconnections or cleanup tasks when the sender is no longer able to send data.

<a name="ProcessSender.StartWorkerPool"></a>
### func \(\*ProcessSender\) [StartWorkerPool](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/processes/processsender/task.go#L42>)

```go
func (s *ProcessSender) StartWorkerPool(_ context.Context, queue <-chan *model.ProcessPayload, workerCount int)
```

StartWorkerPool starts a pool of workers to process incoming process payloads. Each worker will attempt to send the payload to the gRPC server. The number of workers is determined by the workerCount parameter. The workers will run until the context is done or an error occurs. The function uses a goroutine for each worker, allowing them to run concurrently.

# linuxcollector

```go
import "github.com/aaronlmathis/gosight-agent/internal/logs/logcollector/linux"
```

internal/logs/logcollector/linux/doc.go Package linuxcollector contains log collection

SPDX\-License\-Identifier: GPL\-3.0\-or\-later

Copyright \(C\) 2025 Aaron Mathis aaron.mathis@gmail.com

This file is part of GoSight.

GoSight is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or \(at your option\) any later version.

GoSight is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with GoSight. If not, see https://www.gnu.org/licenses/.

internal/logs/logcollector/linux/security\_linux.go Package linuxcollector provides log collection functionality for Linux systems. It includes a SecurityLogCollector that tails and parses security logs from common log files like /var/log/secure and /var/log/auth.log.

## Index

- [type JournaldCollector](<#JournaldCollector>)
  - [func NewJournaldCollector\(cfg \*config.Config\) \*JournaldCollector](<#NewJournaldCollector>)
  - [func \(j \*JournaldCollector\) Close\(\) error](<#JournaldCollector.Close>)
  - [func \(j \*JournaldCollector\) Collect\(ctx context.Context\) \(\[\]\[\]model.LogEntry, error\)](<#JournaldCollector.Collect>)
  - [func \(j \*JournaldCollector\) Name\(\) string](<#JournaldCollector.Name>)
- [type SecurityLogCollector](<#SecurityLogCollector>)
  - [func NewSecurityLogCollector\(cfg \*config.Config\) \*SecurityLogCollector](<#NewSecurityLogCollector>)
  - [func \(c \*SecurityLogCollector\) Close\(\)](<#SecurityLogCollector.Close>)
  - [func \(c \*SecurityLogCollector\) Collect\(\_ context.Context\) \(\[\]\[\]model.LogEntry, error\)](<#SecurityLogCollector.Collect>)
  - [func \(c \*SecurityLogCollector\) Name\(\) string](<#SecurityLogCollector.Name>)


<a name="JournaldCollector"></a>
## type [JournaldCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/journald_linux.go#L44-L56>)

JournaldCollector streams log entries using an asynchronous background reader.

```go
type JournaldCollector struct {
    Config *config.Config
    // contains filtered or unexported fields
}
```

<a name="NewJournaldCollector"></a>
### func [NewJournaldCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/journald_linux.go#L64>)

```go
func NewJournaldCollector(cfg *config.Config) *JournaldCollector
```

NewJournaldCollector initializes a new JournaldCollector.

<a name="JournaldCollector.Close"></a>
### func \(\*JournaldCollector\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/journald_linux.go#L287>)

```go
func (j *JournaldCollector) Close() error
```

Close stops the background reader and closes the journal handle. Implements io.Closer.

<a name="JournaldCollector.Collect"></a>
### func \(\*JournaldCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/journald_linux.go#L213>)

```go
func (j *JournaldCollector) Collect(ctx context.Context) ([][]model.LogEntry, error)
```

Collect drains the internal 'lines' channel and batches the entries.

<a name="JournaldCollector.Name"></a>
### func \(\*JournaldCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/journald_linux.go#L59>)

```go
func (j *JournaldCollector) Name() string
```

Name returns the name of the collector.

<a name="SecurityLogCollector"></a>
## type [SecurityLogCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/security_linux.go#L48-L59>)

SecurityLogCollector is a log collector for security logs. It uses the tail library to follow log files and parse log entries. It collects logs from common security log files like /var/log/secure and /var/log/auth.log.

```go
type SecurityLogCollector struct {
    Config *config.Config
    // contains filtered or unexported fields
}
```

<a name="NewSecurityLogCollector"></a>
### func [NewSecurityLogCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/security_linux.go#L64>)

```go
func NewSecurityLogCollector(cfg *config.Config) *SecurityLogCollector
```

NewSecurityLogCollector initializes a new SecurityLogCollector. It checks for the existence of common security log files and sets up a tailer. If no log file is found, it returns a non\-functional collector.

<a name="SecurityLogCollector.Close"></a>
### func \(\*SecurityLogCollector\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/security_linux.go#L184>)

```go
func (c *SecurityLogCollector) Close()
```

Close stops the tailing process gracefully.

<a name="SecurityLogCollector.Collect"></a>
### func \(\*SecurityLogCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/security_linux.go#L208>)

```go
func (c *SecurityLogCollector) Collect(_ context.Context) ([][]model.LogEntry, error)
```

Collect drains the internal 'lines' channel and batches the entries. This is called periodically by the LogRunner.

<a name="SecurityLogCollector.Name"></a>
### func \(\*SecurityLogCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/security_linux.go#L202>)

```go
func (c *SecurityLogCollector) Name() string
```

Name returns the name of the collector. This is used for logging and debugging purposes.

# windowscollector

```go
import "github.com/aaronlmathis/gosight-agent/internal/logs/logcollector/windows"
```

internal/logs/logcollector/windows/doc.go Package linuxcollector contains log collection

## Index

- [type EventViewerCollector](<#EventViewerCollector>)
  - [func NewEventViewerCollector\(\_ \*config.Config, \_ string\) \*EventViewerCollector](<#NewEventViewerCollector>)
  - [func \(e \*EventViewerCollector\) Close\(\) error](<#EventViewerCollector.Close>)
  - [func \(e \*EventViewerCollector\) Collect\(\_ context.Context\) \(\[\]\[\]model.LogEntry, error\)](<#EventViewerCollector.Collect>)
  - [func \(e \*EventViewerCollector\) Name\(\) string](<#EventViewerCollector.Name>)


<a name="EventViewerCollector"></a>
## type [EventViewerCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/windows/eventviewer_stub.go#L13>)



```go
type EventViewerCollector struct{}
```

<a name="NewEventViewerCollector"></a>
### func [NewEventViewerCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/windows/eventviewer_stub.go#L15>)

```go
func NewEventViewerCollector(_ *config.Config, _ string) *EventViewerCollector
```



<a name="EventViewerCollector.Close"></a>
### func \(\*EventViewerCollector\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/windows/eventviewer_stub.go#L27>)

```go
func (e *EventViewerCollector) Close() error
```



<a name="EventViewerCollector.Collect"></a>
### func \(\*EventViewerCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/windows/eventviewer_stub.go#L23>)

```go
func (e *EventViewerCollector) Collect(_ context.Context) ([][]model.LogEntry, error)
```



<a name="EventViewerCollector.Name"></a>
### func \(\*EventViewerCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/windows/eventviewer_stub.go#L19>)

```go
func (e *EventViewerCollector) Name() string
```



# container

```go
import "github.com/aaronlmathis/gosight-agent/internal/metrics/metriccollector/container"
```

## Index

- [func ExtractAllDockerMetrics\(stats types.StatsJSON, dims map\[string\]string, ts time.Time\) \[\]model.Metric](<#ExtractAllDockerMetrics>)
- [type DockerCollector](<#DockerCollector>)
  - [func NewDockerCollector\(\) \*DockerCollector](<#NewDockerCollector>)
  - [func \(c \*DockerCollector\) Collect\(ctx context.Context\) \(\[\]model.Metric, error\)](<#DockerCollector.Collect>)
  - [func \(c \*DockerCollector\) Name\(\) string](<#DockerCollector.Name>)
- [type PodmanCollector](<#PodmanCollector>)
  - [func NewPodmanCollector\(\) \*PodmanCollector](<#NewPodmanCollector>)
  - [func NewPodmanCollectorWithSocket\(path string\) \*PodmanCollector](<#NewPodmanCollectorWithSocket>)
  - [func \(c \*PodmanCollector\) Collect\(\_ context.Context\) \(\[\]model.Metric, error\)](<#PodmanCollector.Collect>)
  - [func \(c \*PodmanCollector\) Name\(\) string](<#PodmanCollector.Name>)
- [type PodmanContainer](<#PodmanContainer>)
- [type PodmanInspect](<#PodmanInspect>)
- [type PodmanStats](<#PodmanStats>)
- [type PortMapping](<#PortMapping>)


<a name="ExtractAllDockerMetrics"></a>
## func [ExtractAllDockerMetrics](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/docker.go#L150>)

```go
func ExtractAllDockerMetrics(stats types.StatsJSON, dims map[string]string, ts time.Time) []model.Metric
```

ExtractAllDockerMetrics extracts all Docker metrics from the given stats and returns them as a slice of model.Metric. It includes CPU, memory, network, and block I/O metrics. The metrics are tagged with the provided dimensions and timestamp. This function is used to collect detailed metrics for each container. It is called from the Collect method after retrieving the container stats.

<a name="DockerCollector"></a>
## type [DockerCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/docker.go#L42-L44>)



```go
type DockerCollector struct {
    // contains filtered or unexported fields
}
```

<a name="NewDockerCollector"></a>
### func [NewDockerCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/docker.go#L49>)

```go
func NewDockerCollector() *DockerCollector
```

NewDockerCollector creates a new Docker collector It initializes the Docker client using environment variables and API version negotiation.

<a name="DockerCollector.Collect"></a>
### func \(\*DockerCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/docker.go#L66>)

```go
func (c *DockerCollector) Collect(ctx context.Context) ([]model.Metric, error)
```

Collect retrieves metrics from Docker containers It uses the Docker API to get a list of containers and their stats. It returns a slice of metrics that can be sent to the server.

<a name="DockerCollector.Name"></a>
### func \(\*DockerCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/docker.go#L59>)

```go
func (c *DockerCollector) Name() string
```

Name returns the name of the collector This is used to identify the collector in logs and metrics.

<a name="PodmanCollector"></a>
## type [PodmanCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/podman.go#L43-L45>)

PodmanCollector collects metrics from Podman containers. It uses the Podman API to fetch container stats and metadata.

```go
type PodmanCollector struct {
    SocketPath string
}
```

<a name="NewPodmanCollector"></a>
### func [NewPodmanCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/podman.go#L124>)

```go
func NewPodmanCollector() *PodmanCollector
```

NewPodmanCollector creates a new PodmanCollector with the default socket path. The default socket path is "/run/podman/podman.sock".

<a name="NewPodmanCollectorWithSocket"></a>
### func [NewPodmanCollectorWithSocket](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/podman.go#L131>)

```go
func NewPodmanCollectorWithSocket(path string) *PodmanCollector
```

NewPodmanCollectorWithSocket creates a new PodmanCollector with a custom socket path. This is useful for testing or if the Podman socket is located in a different path. The socket path should be the full path to the Podman socket file.

<a name="PodmanCollector.Collect"></a>
### func \(\*PodmanCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/podman.go#L146>)

```go
func (c *PodmanCollector) Collect(_ context.Context) ([]model.Metric, error)
```

Collect fetches container metrics from the Podman API. It returns a slice of model.Metric containing the collected metrics. If an error occurs during the collection process, it returns the error. The metrics include CPU usage, memory usage, network statistics, and container state.

<a name="PodmanCollector.Name"></a>
### func \(\*PodmanCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/podman.go#L138>)

```go
func (c *PodmanCollector) Name() string
```

Name returns the name of the collector. This is used for logging and debugging purposes. It returns "podman" for the PodmanCollector.

<a name="PodmanContainer"></a>
## type [PodmanContainer](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/podman.go#L57-L66>)

PodmanContainer represents a Podman container. It contains metadata about the container, including its ID, name, image, state, labels, and ports. The ID is a unique identifier for the container. The Names field contains the names of the container. The Image field contains the name of the image used to create the container. The State field indicates the current state of the container \(e.g., running, stopped\). The Labels field contains key\-value pairs of labels associated with the container. The Ports field contains a list of port mappings for the container. The Mounts field contains information about the mounts used by the container. The StartedAt field contains the time when the container was started.

```go
type PodmanContainer struct {
    ID        string            `json:"Id"`
    Names     []string          `json:"Names"`
    Image     string            `json:"Image"`
    State     string            `json:"State"`
    Labels    map[string]string `json:"Labels"`
    Ports     []PortMapping     `json:"Ports"`
    Mounts    []any             `json:"Mounts"`
    StartedAt time.Time
}
```

<a name="PodmanInspect"></a>
## type [PodmanInspect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/podman.go#L74-L78>)

PodmanInspect represents the inspect data for a Podman container. It contains the state of the container, including the time when it was started. The State field contains information about the container's state. The StartedAt field contains the time when the container was started. The State field is a nested struct that contains the StartedAt field. The StartedAt field is a string in RFC3339 format.

```go
type PodmanInspect struct {
    State struct {
        StartedAt string `json:"StartedAt"`
    } `json:"State"`
}
```

<a name="PodmanStats"></a>
## type [PodmanStats](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/podman.go#L88-L109>)



```go
type PodmanStats struct {
    Read     string `json:"read"`
    Name     string `json:"name"`
    ID       string `json:"id"`
    CPUStats struct {
        CPUUsage struct {
            TotalUsage        uint64 `json:"total_usage"`
            UsageInKernelmode uint64 `json:"usage_in_kernelmode"`
            UsageInUsermode   uint64 `json:"usage_in_usermode"`
        }   `json:"cpu_usage"`
        SystemCPUUsage uint64 `json:"system_cpu_usage"`
        OnlineCPUs     int    `json:"online_cpus"`
    }   `json:"cpu_stats"`
    MemoryStats struct {
        Usage uint64 `json:"usage_bytes"`
        Limit uint64 `json:"limit_bytes"`
    }   `json:"memory_stats"`
    Networks map[string]struct {
        RxBytes uint64 `json:"rx_bytes"`
        TxBytes uint64 `json:"tx_bytes"`
    }   `json:"networks"`
}
```

<a name="PortMapping"></a>
## type [PortMapping](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/container/podman.go#L116-L120>)

PortMapping represents a port mapping for a Podman container. It contains the private port, public port, and type of mapping. The PrivatePort field contains the private port number. The PublicPort field contains the public port number. The Type field contains the type of mapping \(e.g., tcp, udp\).

```go
type PortMapping struct {
    PrivatePort int    `json:"PrivatePort"`
    PublicPort  int    `json:"PublicPort"`
    Type        string `json:"Type"`
}
```

# system

```go
import "github.com/aaronlmathis/gosight-agent/internal/metrics/metriccollector/system"
```

## Index

- [type CPUCollector](<#CPUCollector>)
  - [func NewCPUCollector\(interval time.Duration\) \*CPUCollector](<#NewCPUCollector>)
  - [func \(c \*CPUCollector\) Collect\(ctx context.Context\) \(\[\]model.Metric, error\)](<#CPUCollector.Collect>)
  - [func \(c \*CPUCollector\) Name\(\) string](<#CPUCollector.Name>)
- [type DiskCollector](<#DiskCollector>)
  - [func NewDiskCollector\(\) \*DiskCollector](<#NewDiskCollector>)
  - [func \(c \*DiskCollector\) Collect\(\_ context.Context\) \(\[\]model.Metric, error\)](<#DiskCollector.Collect>)
  - [func \(c \*DiskCollector\) Name\(\) string](<#DiskCollector.Name>)
- [type HostCollector](<#HostCollector>)
  - [func NewHostCollector\(\) \*HostCollector](<#NewHostCollector>)
  - [func \(c \*HostCollector\) Collect\(ctx context.Context\) \(\[\]model.Metric, error\)](<#HostCollector.Collect>)
  - [func \(c \*HostCollector\) Name\(\) string](<#HostCollector.Name>)
- [type MEMCollector](<#MEMCollector>)
  - [func NewMemCollector\(\) \*MEMCollector](<#NewMemCollector>)
  - [func \(c \*MEMCollector\) Collect\(\_ context.Context\) \(\[\]model.Metric, error\)](<#MEMCollector.Collect>)
  - [func \(c \*MEMCollector\) Name\(\) string](<#MEMCollector.Name>)
- [type NetworkCollector](<#NetworkCollector>)
  - [func NewNetworkCollector\(\) \*NetworkCollector](<#NewNetworkCollector>)
  - [func \(c \*NetworkCollector\) Collect\(\_ context.Context\) \(\[\]model.Metric, error\)](<#NetworkCollector.Collect>)
  - [func \(c \*NetworkCollector\) Name\(\) string](<#NetworkCollector.Name>)


<a name="CPUCollector"></a>
## type [CPUCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/cpu.go#L42-L44>)

CPUCollector is a struct that collects CPU metrics. It implements the Collector interface and is used to gather CPU usage, times, and information about the CPU cores.

```go
type CPUCollector struct {
    // contains filtered or unexported fields
}
```

<a name="NewCPUCollector"></a>
### func [NewCPUCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/cpu.go#L49>)

```go
func NewCPUCollector(interval time.Duration) *CPUCollector
```

NewCPUCollector creates a new CPUCollector instance. It initializes the collector with a specified interval for collecting metrics. If the interval is less than or equal to zero, it defaults to 2 seconds.

<a name="CPUCollector.Collect"></a>
### func \(\*CPUCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/cpu.go#L70>)

```go
func (c *CPUCollector) Collect(ctx context.Context) ([]model.Metric, error)
```

Collect gathers CPU metrics and returns them as a slice of model.Metric. It uses the gopsutil library to get CPU usage, times, and information about the CPU cores. The metrics include per\-core usage, total CPU usage, CPU times \(cumulative\), clock speed per core, logical and physical core counts, and load averages \(1, 5, 15 min\). The metrics are returned as a slice of model.Metric, which includes the namespace, sub\-namespace, name, timestamp, value, type, unit, and dimensions for each metric. The dimensions include information such as core number, vendor ID, model name, stepping, cache size, family, and whether the CPU is physical or not.

<a name="CPUCollector.Name"></a>
### func \(\*CPUCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/cpu.go#L58>)

```go
func (c *CPUCollector) Name() string
```

Name returns the name of the collector. This is used to identify the collector in logs and metrics.

<a name="DiskCollector"></a>
## type [DiskCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/disk.go#L41>)



```go
type DiskCollector struct{}
```

<a name="NewDiskCollector"></a>
### func [NewDiskCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/disk.go#L50>)

```go
func NewDiskCollector() *DiskCollector
```

NewDiskCollector creates a new DiskCollector instance. It uses the gopsutil library to gather disk metrics. The collector is platform\-neutral and will skip virtual, pseudo, and temp filesystems on Linux/macOS. On Windows, it will skip reserved, empty, mapped, and unmounted drives. The collector gathers metrics such as total, used, free space, used percentage, inodes total, used, free, and used percentage. It also collects disk I/O metrics such as read/write counts, bytes, time, and merged counts. The metrics are returned as a slice of model.Metric.

<a name="DiskCollector.Collect"></a>
### func \(\*DiskCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/disk.go#L64>)

```go
func (c *DiskCollector) Collect(_ context.Context) ([]model.Metric, error)
```

Collect gathers disk metrics using the gopsutil library. It retrieves information about disk partitions, usage, and I/O statistics. The metrics are filtered based on the platform \(Linux/macOS/Windows\) to exclude virtual, pseudo, and temp filesystems. The function returns a slice of model.Metric containing the collected metrics.

<a name="DiskCollector.Name"></a>
### func \(\*DiskCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/disk.go#L56>)

```go
func (c *DiskCollector) Name() string
```

Name returns the name of the collector. This is used for logging and debugging purposes.

<a name="HostCollector"></a>
## type [HostCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/host.go#L40>)



```go
type HostCollector struct{}
```

<a name="NewHostCollector"></a>
### func [NewHostCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/host.go#L46>)

```go
func NewHostCollector() *HostCollector
```

NewHostCollector creates a new HostCollector instance. It initializes the collector and returns a pointer to it. This collector gathers host system information such as uptime, number of processes, and number of logged\-in users.

<a name="HostCollector.Collect"></a>
### func \(\*HostCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/host.go#L59>)

```go
func (c *HostCollector) Collect(ctx context.Context) ([]model.Metric, error)
```

Collect gathers host system information and returns it as a slice of model.Metric. It uses the gopsutil library to get host information such as uptime, number of processes, and number of logged\-in users.

<a name="HostCollector.Name"></a>
### func \(\*HostCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/host.go#L52>)

```go
func (c *HostCollector) Name() string
```

Name returns the name of the collector. This is used to identify the collector in logs and metrics.

<a name="MEMCollector"></a>
## type [MEMCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/mem.go#L40>)



```go
type MEMCollector struct{}
```

<a name="NewMemCollector"></a>
### func [NewMemCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/mem.go#L44>)

```go
func NewMemCollector() *MEMCollector
```

NewMemCollector creates a new MEMCollector instance. It initializes the collector and returns a pointer to it.

<a name="MEMCollector.Collect"></a>
### func \(\*MEMCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/mem.go#L57>)

```go
func (c *MEMCollector) Collect(_ context.Context) ([]model.Metric, error)
```

Collect gathers memory metrics and returns them as a slice of model.Metric. It uses the gopsutil library to get virtual and swap memory information. The metrics include total, available, used memory, and swap memory details.

<a name="MEMCollector.Name"></a>
### func \(\*MEMCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/mem.go#L50>)

```go
func (c *MEMCollector) Name() string
```

Name returns the name of the collector. This is used to identify the collector in logs and metrics.

<a name="NetworkCollector"></a>
## type [NetworkCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/network.go#L38>)



```go
type NetworkCollector struct{}
```

<a name="NewNetworkCollector"></a>
### func [NewNetworkCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/network.go#L45>)

```go
func NewNetworkCollector() *NetworkCollector
```

NewNetworkCollector creates a new NetworkCollector instance. It initializes the collector and returns a pointer to it. This collector gathers network interface I/O statistics using the gopsutil library. It collects metrics such as bytes sent, bytes received, packets sent, packets received, and errors in/out for each network interface on the system.

<a name="NetworkCollector.Collect"></a>
### func \(\*NetworkCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/network.go#L59>)

```go
func (c *NetworkCollector) Collect(_ context.Context) ([]model.Metric, error)
```

Collect gathers network interface I/O statistics and returns them as a slice of model.Metric. It uses the gopsutil library to get network I/O counters for each interface. The metrics include bytes sent, bytes received, packets sent, packets received, and errors in/out for each network interface.

<a name="NetworkCollector.Name"></a>
### func \(\*NetworkCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metriccollector/system/network.go#L51>)

```go
func (c *NetworkCollector) Name() string
```

Name returns the name of the collector. This is used to identify the collector in logs and metrics.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
