<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# linuxcollector

```go
import "github.com/aaronlmathis/gosight-agent/internal/logs/logcollector/linux"
```

internal/logs/logcollector/linux/doc.go Package linuxcollector contains log collection

SPDX\-License\-Identifier: GPL\-3.0\-or\-later

Copyright \(C\) 2025 Aaron Mathis aaron.mathis@gmail.com

This file is part of GoSight.

GoSight is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or \(at your option\) any later version.

GoSight is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with GoSight. If not, see https://www.gnu.org/licenses/.

internal/logs/logcollector/linux/security\_linux.go Package linuxcollector provides log collection functionality for Linux systems. It includes a SecurityLogCollector that tails and parses security logs from common log files like /var/log/secure and /var/log/auth.log.

## Index

- [type JournaldCollector](<#JournaldCollector>)
  - [func NewJournaldCollector\(cfg \*config.Config\) \*JournaldCollector](<#NewJournaldCollector>)
  - [func \(j \*JournaldCollector\) Close\(\) error](<#JournaldCollector.Close>)
  - [func \(j \*JournaldCollector\) Collect\(ctx context.Context\) \(\[\]\[\]model.LogEntry, error\)](<#JournaldCollector.Collect>)
  - [func \(j \*JournaldCollector\) Name\(\) string](<#JournaldCollector.Name>)
- [type SecurityLogCollector](<#SecurityLogCollector>)
  - [func NewSecurityLogCollector\(cfg \*config.Config\) \*SecurityLogCollector](<#NewSecurityLogCollector>)
  - [func \(c \*SecurityLogCollector\) Close\(\)](<#SecurityLogCollector.Close>)
  - [func \(c \*SecurityLogCollector\) Collect\(\_ context.Context\) \(\[\]\[\]model.LogEntry, error\)](<#SecurityLogCollector.Collect>)
  - [func \(c \*SecurityLogCollector\) Name\(\) string](<#SecurityLogCollector.Name>)


<a name="JournaldCollector"></a>
## type [JournaldCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/journald_linux.go#L44-L56>)

JournaldCollector streams log entries using an asynchronous background reader.

```go
type JournaldCollector struct {
    Config *config.Config
    // contains filtered or unexported fields
}
```

<a name="NewJournaldCollector"></a>
### func [NewJournaldCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/journald_linux.go#L64>)

```go
func NewJournaldCollector(cfg *config.Config) *JournaldCollector
```

NewJournaldCollector initializes a new JournaldCollector.

<a name="JournaldCollector.Close"></a>
### func \(\*JournaldCollector\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/journald_linux.go#L287>)

```go
func (j *JournaldCollector) Close() error
```

Close stops the background reader and closes the journal handle. Implements io.Closer.

<a name="JournaldCollector.Collect"></a>
### func \(\*JournaldCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/journald_linux.go#L213>)

```go
func (j *JournaldCollector) Collect(ctx context.Context) ([][]model.LogEntry, error)
```

Collect drains the internal 'lines' channel and batches the entries.

<a name="JournaldCollector.Name"></a>
### func \(\*JournaldCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/journald_linux.go#L59>)

```go
func (j *JournaldCollector) Name() string
```

Name returns the name of the collector.

<a name="SecurityLogCollector"></a>
## type [SecurityLogCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/security_linux.go#L48-L59>)

SecurityLogCollector is a log collector for security logs. It uses the tail library to follow log files and parse log entries. It collects logs from common security log files like /var/log/secure and /var/log/auth.log.

```go
type SecurityLogCollector struct {
    Config *config.Config
    // contains filtered or unexported fields
}
```

<a name="NewSecurityLogCollector"></a>
### func [NewSecurityLogCollector](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/security_linux.go#L64>)

```go
func NewSecurityLogCollector(cfg *config.Config) *SecurityLogCollector
```

NewSecurityLogCollector initializes a new SecurityLogCollector. It checks for the existence of common security log files and sets up a tailer. If no log file is found, it returns a non\-functional collector.

<a name="SecurityLogCollector.Close"></a>
### func \(\*SecurityLogCollector\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/security_linux.go#L184>)

```go
func (c *SecurityLogCollector) Close()
```

Close stops the tailing process gracefully.

<a name="SecurityLogCollector.Collect"></a>
### func \(\*SecurityLogCollector\) [Collect](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/security_linux.go#L208>)

```go
func (c *SecurityLogCollector) Collect(_ context.Context) ([][]model.LogEntry, error)
```

Collect drains the internal 'lines' channel and batches the entries. This is called periodically by the LogRunner.

<a name="SecurityLogCollector.Name"></a>
### func \(\*SecurityLogCollector\) [Name](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/logs/logcollector/linux/security_linux.go#L202>)

```go
func (c *SecurityLogCollector) Name() string
```

Name returns the name of the collector. This is used for logging and debugging purposes.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
