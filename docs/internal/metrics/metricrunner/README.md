<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# metricrunner

```go
import "github.com/aaronlmathis/gosight-agent/internal/metrics/metricrunner"
```

SPDX\-License\-Identifier: GPL\-3.0\-or\-later

Copyright \(C\) 2025 Aaron Mathis aaron.mathis@gmail.com

This file is part of GoSight.

GoSight is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or \(at your option\) any later version.

GoSight is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with GoSight. If not, see https://www.gnu.org/licenses/.

agent/internal/metrics/metricrunner/runner.go

## Index

- [type MetricRunner](<#MetricRunner>)
  - [func NewRunner\(ctx context.Context, cfg \*config.Config, baseMeta \*model.Meta\) \(\*MetricRunner, error\)](<#NewRunner>)
  - [func \(r \*MetricRunner\) Close\(\)](<#MetricRunner.Close>)
  - [func \(r \*MetricRunner\) Run\(ctx context.Context\)](<#MetricRunner.Run>)


<a name="MetricRunner"></a>
## type [MetricRunner](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricrunner/runner.go#L41-L47>)

MetricRunner is a struct that handles the collection and sending of metrics. It manages the metric collection interval, the task queue, and the metric sender. It implements the Run method to start the collection process and the Close method to clean up resources.

```go
type MetricRunner struct {
    Config         *config.Config
    MetricSender   *metricsender.MetricSender
    MetricRegistry *metriccollector.MetricRegistry
    StartTime      time.Time
    Meta           *model.Meta
}
```

<a name="NewRunner"></a>
### func [NewRunner](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricrunner/runner.go#L53>)

```go
func NewRunner(ctx context.Context, cfg *config.Config, baseMeta *model.Meta) (*MetricRunner, error)
```

NewRunner creates a new MetricRunner instance. It initializes the metric sender and sets up the context for the runner. It returns a pointer to the MetricRunner and an error if any occurs during initialization. The MetricRunner is responsible for collecting and sending metrics to the server.

<a name="MetricRunner.Close"></a>
### func \(\*MetricRunner\) [Close](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricrunner/runner.go#L76>)

```go
func (r *MetricRunner) Close()
```

Close closes the metric sender. It cleans up resources and ensures that the sender is properly closed. This is important to prevent resource leaks and ensure that all data is sent before shutting down.

<a name="MetricRunner.Run"></a>
### func \(\*MetricRunner\) [Run](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/metrics/metricrunner/runner.go#L87>)

```go
func (r *MetricRunner) Run(ctx context.Context)
```

RunAgent starts the agent's collection loop and sends tasks to the pool of workers. It collects metrics at the specified interval and sends them to the server. The method runs indefinitely until the context is done. It handles the collection of both host and container metrics. The host metrics are sent as a single payload, while container metrics are sent as separate payloads.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
