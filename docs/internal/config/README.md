<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# config

```go
import "github.com/aaronlmathis/gosight-agent/internal/config"
```

SPDX\-License\-Identifier: GPL\-3.0\-or\-later

Copyright \(C\) 2025 Aaron Mathis aaron.mathis@gmail.com

This file is part of GoSight.

GoSight is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or \(at your option\) any later version.

GoSight is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with GoSight. If not, see https://www.gnu.org/licenses/.

internal/config/config.go Package config provides functions to load and manage the configuration for the GoSight agent. It handles loading the configuration from a YAML file, applying environment variable overrides, and parsing CSV strings into slices. The configuration includes settings for TLS, logging, Podman and Docker integration, custom tags, and various collection intervals for metrics, logs, and processes. The configuration is structured to allow for easy modification and extension as needed.

internal/config/doc.go Package config handles reading, parsing, and validating the GoSight agent configuration file.

## Index

- [func ApplyEnvOverrides\(cfg \*Config\)](<#ApplyEnvOverrides>)
- [func EnsureDefaultConfig\(path string\) error](<#EnsureDefaultConfig>)
- [func SplitCSV\(input string\) \[\]string](<#SplitCSV>)
- [type Config](<#Config>)
  - [func LoadConfig\(path string\) \(\*Config, error\)](<#LoadConfig>)
- [type EventViewerConfig](<#EventViewerConfig>)
- [type LogCollectionConfig](<#LogCollectionConfig>)
- [type MetricCollectionConfig](<#MetricCollectionConfig>)
- [type ProcessCollectionConfig](<#ProcessCollectionConfig>)


<a name="ApplyEnvOverrides"></a>
## func [ApplyEnvOverrides](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L154>)

```go
func ApplyEnvOverrides(cfg *Config)
```

ApplyEnvOverrides applies environment variable overrides to the configuration. It checks for specific environment variables and updates the corresponding fields in the Config struct. If an environment variable is set, it overrides the value in the configuration. The function prints the overridden values to the console. This allows users to customize the configuration without modifying the YAML file. The function handles various settings such as server URL, collection intervals, log file paths, TLS certificates, and custom tags. It also validates the format of the GOSIGHT\_INTERVAL environment variable to ensure it is a valid duration.

<a name="EnsureDefaultConfig"></a>
## func [EnsureDefaultConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/default.go#L74>)

```go
func EnsureDefaultConfig(path string) error
```



<a name="SplitCSV"></a>
## func [SplitCSV](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L253>)

```go
func SplitCSV(input string) []string
```

SplitCSV splits a CSV string into a slice of strings. It trims whitespace from each element and ignores empty elements. This function is useful for parsing comma\-separated values from configuration files.

<a name="Config"></a>
## type [Config](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L83-L125>)

Config holds the configuration for the GoSight agent. It includes settings for TLS, logging, Podman and Docker integration, custom tags, and various collection intervals for metrics, logs, and processes. The configuration is loaded from a YAML file and can be overridden by environment variables. The configuration is structured to allow for easy modification and extension as needed.

```go
type Config struct {
    TLS struct {
        CAFile   string `yaml:"ca_file"`   // used by agent to trust the server
        CertFile string `yaml:"cert_file"` // optional (for mTLS)
        KeyFile  string `yaml:"key_file"`  // optional (for mTLS)
    }

    Logs struct {
        ErrorLogFile  string `yaml:"error_log_file"`
        AppLogFile    string `yaml:"app_log_file"`
        AccessLogFile string `yaml:"access_log_file"`
        LogLevel      string `yaml:"log_level"`
    }

    Podman struct {
        Socket  string `yaml:"socket"`
        Enabled bool   `yaml:"enabled"`
    }

    Docker struct {
        Socket  string `yaml:"socket"`
        Enabled bool   `yaml:"enabled"`
    }

    CustomTags map[string]string `yaml:"custom_tags"` // static tags to be sent with every metric

    Agent struct {
        ServerURL    string        `yaml:"server_url"`
        Interval     time.Duration `yaml:"interval"`
        HostOverride string        `yaml:"host"`

        MetricCollection  MetricCollectionConfig  `yaml:"metric_collection"`
        LogCollection     LogCollectionConfig     `yaml:"log_collection"`
        ProcessCollection ProcessCollectionConfig `yaml:"process_collection"`

        Environment   string `yaml:"environment"`
        AppLogFile    string `yaml:"app_log_file"`
        ErrorLogFile  string `yaml:"error_log_file"`
        AccessLogFile string `yaml:"access_log_file"`
        DebugLogFile  string `yaml:"debug_log_file"`
        LogLevel      string `yaml:"log_level"`
    }
}
```

<a name="LoadConfig"></a>
### func [LoadConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L133>)

```go
func LoadConfig(path string) (*Config, error)
```

LoadConfig loads the configuration from a YAML file. It returns a Config struct and an error if any occurred during loading. The configuration file path is passed as an argument. The function reads the file, unmarshals the YAML data into the Config struct, and returns the struct. If the file cannot be read or the data cannot be unmarshaled, an error is returned.

<a name="EventViewerConfig"></a>
## type [EventViewerConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L55-L59>)

EventViewerConfig defines the configuration for Windows Event Log collection

```go
type EventViewerConfig struct {
    CollectAll      bool     `yaml:"collect_all"`      // Whether to collect from all available channels
    Channels        []string `yaml:"channels"`         // List of channels to collect from if CollectAll is false
    ExcludeChannels []string `yaml:"exclude_channels"` // Channels to explicitly exclude
}
```

<a name="LogCollectionConfig"></a>
## type [LogCollectionConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L43-L52>)



```go
type LogCollectionConfig struct {
    Interval    time.Duration     `yaml:"interval"`
    Sources     []string          `yaml:"sources"`
    Services    []string          `yaml:"services"`
    BatchSize   int               `yaml:"batch_size"`
    BufferSize  int               `yaml:"buffer_size"`
    Workers     int               `yaml:"workers"`
    MessageMax  int               `yaml:"message_max"`
    EventViewer EventViewerConfig `yaml:"eventviewer"`
}
```

<a name="MetricCollectionConfig"></a>
## type [MetricCollectionConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L64-L68>)

MetricCollectionConfig defines the configuration for metric collection It includes settings for the collection interval, sources, and number of workers. The sources can be a list of metrics to collect, such as CPU, memory, etc.

```go
type MetricCollectionConfig struct {
    Interval time.Duration `yaml:"interval"`
    Sources  []string      `yaml:"sources"`
    Workers  int           `yaml:"workers"`
}
```

<a name="ProcessCollectionConfig"></a>
## type [ProcessCollectionConfig](<https://github.com/aaronlmathis/gosight-agent/blob/main/internal/config/config.go#L73-L76>)

ProcessCollectionConfig defines the configuration for process collection It includes settings for the collection interval and number of workers. The process collection can be used to monitor running processes and their resource usage.

```go
type ProcessCollectionConfig struct {
    Interval time.Duration `yaml:"interval"`
    Workers  int           `yaml:"workers"`
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
